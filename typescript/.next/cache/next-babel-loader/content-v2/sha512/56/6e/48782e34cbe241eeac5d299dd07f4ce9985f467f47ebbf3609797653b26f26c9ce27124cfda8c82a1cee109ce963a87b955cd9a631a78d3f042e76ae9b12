{"ast":null,"code":"import { applyMiddleware, createStore } from 'redux';\nimport { createWrapper } from 'next-redux-wrapper';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport logger from 'redux-logger';\nimport createSagaMiddleware from 'redux-saga';\nimport rootSaga, { rootReducer } from './modules';\n\nconst bindMiddleware = middleware => {\n  if (true) {\n    return composeWithDevTools(applyMiddleware(...middleware, logger));\n  }\n\n  return applyMiddleware(...middleware);\n}; // create a makeStore function\n\n\nconst makeStore = context => {\n  var _localStorage;\n\n  // 1: Create the middleware\n  const sagaMiddleware = createSagaMiddleware();\n  const KEYNAME = 'NEXT-RED-EMO-MAT-STATE'; // if KEYNAME exists in LocalStorage, load it\n\n  const preloadedState = false && (_localStorage = localStorage) !== null && _localStorage !== void 0 && _localStorage.getItem(KEYNAME) ? JSON.parse(localStorage.getItem(KEYNAME)) : {}; // 2: Add an extra parameter for applying middleware:\n\n  const store = createStore(rootReducer, preloadedState, bindMiddleware([sagaMiddleware])); // 3: Run sagas on server\n\n  store.sagaTask = sagaMiddleware.run(rootSaga); // optional: subscribe to store events\n\n  store.subscribe(() => false && localStorage.setItem(KEYNAME, JSON.stringify(store.getState())));\n  return store;\n}; // export an assembled wrapper\n\n\nexport const wrapper = createWrapper(makeStore, {\n  debug: true\n});","map":{"version":3,"sources":["/home/sung/dev/next-red-emo-mat/typescript/src/lib/redux/store.ts"],"names":["applyMiddleware","createStore","createWrapper","composeWithDevTools","logger","createSagaMiddleware","rootSaga","rootReducer","bindMiddleware","middleware","makeStore","context","sagaMiddleware","KEYNAME","preloadedState","localStorage","getItem","JSON","parse","store","sagaTask","run","subscribe","setItem","stringify","getState","wrapper","debug"],"mappings":"AAAA,SAASA,eAAT,EAA0BC,WAA1B,QAAoD,OAApD;AACA,SAAoBC,aAApB,QAAkD,oBAAlD;AACA,SAASC,mBAAT,QAAoC,0BAApC;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,OAAOC,oBAAP,MAA2C,YAA3C;AACA,OAAOC,QAAP,IAAmBC,WAAnB,QAAiD,WAAjD;;AAMA,MAAMC,cAAc,GAAIC,UAAD,IAAgB;AACtC,YAA2C;AAC1C,WAAON,mBAAmB,CAACH,eAAe,CAAC,GAAGS,UAAJ,EAAgBL,MAAhB,CAAhB,CAA1B;AACA;;AACD,SAAOJ,eAAe,CAAC,GAAGS,UAAJ,CAAtB;AACA,CALD,C,CAOA;;;AACA,MAAMC,SAAoB,GAAIC,OAAD,IAAsB;AAAA;;AAClD;AACA,QAAMC,cAAc,GAAGP,oBAAoB,EAA3C;AAEA,QAAMQ,OAAO,GAAG,wBAAhB,CAJkD,CAMlD;;AACA,QAAMC,cAAc,GACnB,0BAAiCC,YAAjC,0CAAiC,cAAcC,OAAd,CAAsBH,OAAtB,CAAjC,GACGI,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqBH,OAArB,CAAX,CADH,GAEG,EAHJ,CAPkD,CAYlD;;AACA,QAAMM,KAAK,GAAGlB,WAAW,CACxBM,WADwB,EAExBO,cAFwB,EAGxBN,cAAc,CAAC,CAACI,cAAD,CAAD,CAHU,CAAzB,CAbkD,CAmBlD;;AACCO,EAAAA,KAAD,CAAqBC,QAArB,GAAgCR,cAAc,CAACS,GAAf,CAAmBf,QAAnB,CAAhC,CApBkD,CAsBlD;;AACAa,EAAAA,KAAK,CAACG,SAAN,CAAgB,MACf,SACAP,YAAY,CAACQ,OAAb,CAAqBV,OAArB,EAA8BI,IAAI,CAACO,SAAL,CAAeL,KAAK,CAACM,QAAN,EAAf,CAA9B,CAFD;AAKA,SAAON,KAAP;AACA,CA7BD,C,CA+BA;;;AACA,OAAO,MAAMO,OAAO,GAAGxB,aAAa,CAAYQ,SAAZ,EAAuB;AAAEiB,EAAAA,KAAK,EAAE;AAAT,CAAvB,CAA7B","sourcesContent":["import { applyMiddleware, createStore, Store } from 'redux';\nimport { MakeStore, createWrapper, Context } from 'next-redux-wrapper';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport logger from 'redux-logger';\nimport createSagaMiddleware, { Task } from 'redux-saga';\nimport rootSaga, { rootReducer, RootState } from './modules';\n\ninterface SagaStore extends Store {\n\tsagaTask?: Task;\n}\n\nconst bindMiddleware = (middleware) => {\n\tif (process.env.NODE_ENV !== 'production') {\n\t\treturn composeWithDevTools(applyMiddleware(...middleware, logger));\n\t}\n\treturn applyMiddleware(...middleware);\n};\n\n// create a makeStore function\nconst makeStore: MakeStore = (context: Context) => {\n\t// 1: Create the middleware\n\tconst sagaMiddleware = createSagaMiddleware();\n\n\tconst KEYNAME = 'NEXT-RED-EMO-MAT-STATE';\n\n\t// if KEYNAME exists in LocalStorage, load it\n\tconst preloadedState =\n\t\ttypeof window !== 'undefined' && localStorage?.getItem(KEYNAME)\n\t\t\t? JSON.parse(localStorage.getItem(KEYNAME) as string)\n\t\t\t: {};\n\n\t// 2: Add an extra parameter for applying middleware:\n\tconst store = createStore(\n\t\trootReducer,\n\t\tpreloadedState,\n\t\tbindMiddleware([sagaMiddleware])\n\t);\n\n\t// 3: Run sagas on server\n\t(store as SagaStore).sagaTask = sagaMiddleware.run(rootSaga);\n\n\t// optional: subscribe to store events\n\tstore.subscribe(() =>\n\t\ttypeof window !== 'undefined' &&\n\t\tlocalStorage.setItem(KEYNAME, JSON.stringify(store.getState()))\n\t);\n\n\treturn store;\n};\n\n// export an assembled wrapper\nexport const wrapper = createWrapper<RootState>(makeStore, { debug: true });\n"]},"metadata":{},"sourceType":"module"}